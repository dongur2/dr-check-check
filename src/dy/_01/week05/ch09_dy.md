# 09 가상 메모리 관리

## 가져오기 정책: 요구 페이징
메모리 관리자가 프로세스가 필요로 하는 데이터를 언제 메모리로 가져올지 결정하는 정책으로, **일반적으로 프로세스가 요청할 때 데이터를 메모리로 가져온다.**

메모리에는 꼭 필요한 프로세스만 유지하게 되는데, 용량이 큰 프로세스의 경우 운영체제는 필요한 모듈만 메모리에 올리고 나머지 모듈은 필요할 때 메모리로 가져온다.

-> 이로써 메모리를 효율적으로 관리 & 응답 속도 향상

1. 프로세스가 페이지를 요청했을 때 메모리에 해당 페이지가 있지 않으면 **페이지 부재** 발생
2. 메모리 관리자가 해당 페이지를 스왑 영역에서 메모리로 이동(스왑 인) :: 페이지 테이블의 각 페이지 주소 업데이트

그런데 메모리에 비어있는 공간이 있다면 스왑 영역에 있던 페이지를 그 자리에 올리면 되지만, 빈 공간이 없을 경우 새로운 페이지 대신 스왑 영역으로 보낼
페이지를 선택해야 한다. 이 때 사용하게 되는 것이 **페이지 교체 알고리즘**


## 재배치 정책: 페이지 교체 알고리즘

페이지 부재가 발생했을 때 메모리가 꽉 찼을 경우, 스왑 영역으로 내보낼 페이지를 결정

- 무작위 페이지 교체 알고리즘
- FIFO: 처음 메모리에 올라온 페이지를 스왑 영역으로 내보냄
- 최적 페이지 교체 알고리즘: 구현 불가
- LRU 페이지 교체 알고리즘: Least Recently Used - 최근 최소 사용 페이지 교체
- LFU 페이지 교체 알고리즘: Least Frequently Used - 최소 빈도 사용 페이지 교체
- NUR 페이지 교체 알고리즘: Not Used Recently page replacement algorithm - 참조 비트와 변경 비트 사용
- FIFO 변형 알고리즘: 2차 기회 페이지 교체 알고리즘 - 페이지 부재 없이 접근 성공 시 해당 페이지를 큐의 맨 뒤로 이동
- 시계 알고리즘: 스왑 영역으로 옮길 대상 페이지를 가리키는 포인터가 한 방향으로 회전

## 스레싱과 프레임 할당

**스레싱**: 하드디스크의 입출력이 너무 많아져서 잦은 페이지 부재로 작업이 멈춘 것 같은 상태

**프레임 할당**
- 정적 할당: 프로세스 실행 초기에 프레임을 나누어 준 후 그 크기를 고정
  - 균등 할당
  - 비례 할당
- 동적 할당: 프로세스 실행 중에 변경되는 메모리 요청을 반영
  - 작업집합 모델: 지역성 이론 - 가장 최근에 접근한 프레임이 이후 참조 가능성이 높음
  - 페이지 부재 빈도: 페이지 부재 비율의 상한선과 하한선을 설정하여 그 선을 넘을 때마다 프레임 수를 조절

실행 중인 여러 프로세스에 프레임을 나눠주는 방식에 따라 시스템의 성능이 달라지는데, 너무 많은 프레임을 할당한다면 페이지 부재는 적어지지만 메모리가 낭비된다.
너무 적은 프레임을 할당한다면 페이지 부재가 잦아져 스레싱 발생 가능성이 높아진다.
