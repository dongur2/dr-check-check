# Chapter 05. 프로세스 동기화

<aside>
💡 학습 목표
- 프로세스 간 통신의 개념을 이해하고 종류를 파악한다.
- 공유 자원 사용 시 임계구역의 문제를 알아본다.
- 임계구역 문제를 해결하기 위한 조건과 해결 방법을 알아본다.

</aside>

## 프로세스 간 통신의 개념 및 종류

- 프로세스 간 통신 Inter Process Communication
  : 운영체제가 제공하는 프로세스끼리 쉽게 데이터를 주고`send(message)`받을`receive(message)` 수 있는 통신 방법
  - 공유 메모리나 공유 파일을 이용한 통신
    - 데이터 주고받는 방법 프로세스끼리 정해야 함
    - 단방향 통신
    - 대기가 없는 통신(비동기화 통신)
    - open(), write(), close()
  - 파이프를 이용한 통신
    - 하나의 컴퓨터 내에서 프로세스간 통신에 가장 많이 사용됨
    - `fork()` 로 만들어진 부모-자식 간 통신에 사용됨
    - 단방향 통신(양방향 하려면 파이프 두 개 필요)
    - 대기가 있는 통신(동기화 통신)
    - open(), close()
  - 소켓을 이용한 통신
    - 컴퓨터와 컴퓨터가 네트워크로 연결된 경우의 통신에 주로 사용
    - 양방향 통신
    - 대기가 있는 통신(동기화 통신)
    - 소켓: 하나의 포트에 여러 클라이언트를 연결하기 위해 필요
- 통신 구현 방식
  - 바쁜 대기: 반복문을 무한 실행하여 수시로 상태 변화하는지 살펴봄
  - 동기화: 데이터가 도착했음을 알려줌(알림)

## 공유 자원과 임계구역

- 공유 자원: 여러 프로세스가 공동으로 이용하는 변수, 메모리, 파일 등
  - 접근 순서가 중요
  - 경쟁 조건: 2개 이상의 프로세스가 공유 자원을 병행해서 읽거나 쓰는 상황
- 임계구역: 공유 자원 접근 순서에 따라 실행 결과가 달라지는 프로그램의 영역
  - 생산자-소비자 문제: 공유 자원에 접근하는 타이밍이 맞지 않아서 발생(사람+물고기 인쇄 → 인어공주 인쇄)

## 임계구역 문제 해결 방법

- 임계구역 문제 해결 조건
  1. 상호 배제: 임계구역 내에는 한 번에 하나의 프로세스만 있어야 함
  2. 한정 대기: 어떤 프로세스도 임계구역에 진입하지 못하고 무한 대기하면 안됨
  3. 진행의 융통성: 작업 속도와 관계없이 공유 자원이 사용 중이지 않으면 언제든 사용할 수 있어야 함
- 해결 방법
  - 세마포어 알고리즘
    - 세마포어 변수 사용(사용중 스위치 같은거)
    - 임계구역 진입 시 사용하는 함수 P(), 임계구역 빠져나올 때 사용하는 함수 V()
    - 위 함수 잘못 사용했을 때 임계구역은 보호받지 못한다는 단점
  - 모니터
    - 임계구역 보호와 동기화를 자동으로 처리
    - 자바의 private, public 영역
      - private 영역에 정의된 변수는 public 영역에 정의된 함수를 통해서만 접근 및 변경 가능
