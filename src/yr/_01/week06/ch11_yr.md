# Chapter11. 파일 시스템

<aside>
💡 학습 목표
- 파일 시스템의 역할과 파일의 속성, 작업 유형, 구조 이해
- 디렉터리의 개념과 구조, 운영 이해
- 디스크 파일 할당 방식 이해
- 빈 공간 관리 방법 이해

</aside>

## 파일 시스템

- 파일 시스템의 개념
  - 파일 관리자를 통해 저장 장치 전체를 관리
  - 파일 관리자는 파일 테이블을 통해 파일의 생성, 수정, 삭제 수행
  - 사용자는 파일 관리자에게 파일 디스크립터(파일 접근 권한, 키)을 받아야 파일에 접근 가능
- 파일 시스템의 기능과 역할
  1. 파일 및 디렉터리 구성
  2. 파일 및 디렉터리 관리
  3. 접근 방법 제공
  4. 접근 권한 관리
  5. 무결성 보장(파일 손상 방지)
  6. 백업과 복구
  7. 암호화
  - 블록
    - 저장장치가 파일을 관리하는 가장 작은 단위
    - 운영체제와 저장장치 사이에 파일을 전송하는 단위
    - 한 블록 당 주소 하나 할당
  - 실행 파일과 데이터 파일
- 파일 이름
  - (윈도우)대소문자를 구분하지 않음
  - 마지막 . 뒤의 것만 확장자로 인식
  - ? , \* → 파일 검색 시 특수 문자로 사용되므로 제목으로 사용 불가
- 파일의 속성
  - 파일의 속성은 파일 헤더에 기록됨
  - 운영체제는 파일 헤더를 파일 테이블에서 관리
  - 종류: name, type, size 등
  - 파일마다 자신에게 필요한 맞춤 정보를 따로 정의해서 사용도 가능 → 헤더에 저장됨
    - ex. mp3 파일의 헤더 → 가수명, 앨범명, 앨범 사진

## 저장장치 관리 기법

- 파티션
  - 저장장치를 분할하는 작업
    - C:드라이브, D:드라이브 이렇게 나누는 것도 파티션 나누기
    - C:드라이브 내에서도 파티션 나누기 가능
  - 하나의 논리적 저장장치에는 하나의 파일 시스템 탑재
    ⇒ 파티션 마다 파일 시스템 탑재
  - 윈도우랑 달리 유닉스는 저장장치나 파티션의 개수에 상관없이 하나의 파일시스템만 가지게 할 수도 있음
    - 마운트: 여러 개의 파티션을 하나로 통합하는 기능
- 포맷: 저장 장치의 파일 시스템 초기화
  - 빠른 포맷
  - 느린 포맷
- 조각 모음
  - 초기에 차곡차곡 쌓였던 데이터가 수정, 삭제 반복되면서 빵꾸남 ⇒ 단편화(조각화)
  - 이렇게 빵꾸나면 파일 읽을 때 이곳 저곳 돌아다녀야 돼서 느려짐
    → 그래서 이 흩어진 조각들을 모아주는 것

## 파일 시스템 구조

- 순차 파일 구조 → 순차 접근
  - 장: 저장 공간 낭비 X, 데이터 순차 처리 속도 빠름
  - 단: 데이터 삽입, 삭제에 시간 오래 걸림, 데이터 검색하는 데도 적합하지 않음
- 인덱스 파일 구조
  - 인덱스 테이블 추가해서 이용
  - 순차 접근, 직접 접근 모두 가능
  - 데이터에 다양한 접근, 빠른 접근이 가능
- 직접 파일 구조
  - 해시 함수를 통해 직접 접근 가능
  - 단: 알맞은 해시 함수 정하는 게 쉬운 일이 아님

## 디렉터리의 구조

- cmd 창에서 유용한 것들
  - cd
  - . 과 ..
- 절대 경로: 다른 디렉터리로 이동할 때
- 상대 경로: 현재 위치보다 아래에 있는 데이터에 접근할 때
- 원래는 순환하지 않는 트리 구조이지만, 유닉스에서는 마운트를 통해 순환 가능

## 디스크 파일 할당

- 연속 할당
- 불연속 할당
  - 연결 할당(체인 할당): 연결 리스트 이용
    - 윈도우의 FAT
    - 데이터 블록을 연결하는 방식
    - 단점: 하나의 파티션이 사용할 수 있는 용량이 테이블의 주소 크기로 제한됨
  - 인덱스 할당: 인덱스 이용
    - 데이터 블록이 아닌 인덱스를 연결하는 방식

## 빈 공간 관리

- 빈 블록의 정보만 모아놓은 ‘빈 공간 리스트’
- 파일이 삭제될 때 블록의 내용이 지워지지 않고 빈 공간 리스트에 삽입됨
  - 즉 파일 삭제 = 파일 테이블의 헤더 삭제 + 사용 블록 빈 공간 리스트에 등록
  ⇒ 이로 인해 디스크 복구나 휴지통에서 파일 되살리기 가능

### 느낀 점

파일 이름 관련해서 새롭게 알게 된 사실이 많았음

파티션 정확히 알게 되어서 다음 노트북 살 때는 실수 안 할 것 같음

파일 복구되는 원리 신기했음
